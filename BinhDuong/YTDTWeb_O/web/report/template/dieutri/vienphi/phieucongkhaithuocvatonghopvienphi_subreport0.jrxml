<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
		 name="phieucongkhaithuocvatonghopvienphi_subreport0"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Landscape"
		 pageWidth="842"
		 pageHeight="595"
		 columnWidth="842"
		 columnSpacing="0"
		 leftMargin="0"
		 rightMargin="0"
		 topMargin="0"
		 bottomMargin="0"
		 whenNoDataType="AllSectionsNoDetail"
		 isTitleNewPage="false"
		 isSummaryNewPage="false">
	<property name="ireport.scriptlethandling" value="0" />
	<property name="ireport.encoding" value="UTF-8" />
	<import value="java.util.*" />
	<import value="net.sf.jasperreports.engine.*" />
	<import value="net.sf.jasperreports.engine.data.*" />
	<import value="com.iesvn.commaseparator.*" />
	<import value="com.iesvn.utils.*" />
	<reportFont name="Time New Roman" isDefault="true" fontName="Times New Roman" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="times.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>

	<parameter name="SOVAOVIEN" isForPrompting="false" class="java.lang.String">
		<defaultValueExpression ><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="TUNGAY" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="DENNGAY" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_01" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_02" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_03" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_04" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_05" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_06" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_07" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_08" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_09" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="NGAY_10" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="KHOAMA" isForPrompting="false" class="java.lang.Integer"/>
	<parameter name="TANGMASO" isForPrompting="false" class="java.lang.Integer"/>
	<queryString><![CDATA[SELECT *
FROM
 (SELECT CAST((CASE WHEN (union_data.DMLOAITHUOC_MA LIKE 'YC') THEN  'Y CỤ' ELSE (CASE WHEN(union_data.DMLOAITHUOC_MA LIKE 'TD') THEN '  TÊN THUỐC, HÀM LƯỢNG' ELSE union_data.MATHUOC END) END) AS CHAR(200)) AS TEN_NHOM,
        union_data.TENTHUOC AS TEN_CHITIET,
       union_data.DONVITINH,
       SUM(union_data.SOLUONG_NGAY01) AS SOLUONG_NGAY01,
       SUM(union_data.THANHTIEN_NGAY01) AS THANHTIEN_NGAY01,
       SUM(union_data.SOLUONG_NGAY02) AS SOLUONG_NGAY02,
       SUM(union_data.THANHTIEN_NGAY02) AS THANHTIEN_NGAY02,
       SUM(union_data.SOLUONG_NGAY03) AS SOLUONG_NGAY03,
       SUM(union_data.THANHTIEN_NGAY03) AS THANHTIEN_NGAY03,
       SUM(union_data.SOLUONG_NGAY04) AS SOLUONG_NGAY04,
       SUM(union_data.THANHTIEN_NGAY04) AS THANHTIEN_NGAY04,
       SUM(union_data.SOLUONG_NGAY05) AS SOLUONG_NGAY05,
       SUM(union_data.THANHTIEN_NGAY05) AS THANHTIEN_NGAY05,
       SUM(union_data.SOLUONG_NGAY06) AS SOLUONG_NGAY06,
       SUM(union_data.THANHTIEN_NGAY06) AS THANHTIEN_NGAY06,
       SUM(union_data.SOLUONG_NGAY07) AS SOLUONG_NGAY07,
       SUM(union_data.THANHTIEN_NGAY07) AS THANHTIEN_NGAY07,
       SUM(union_data.SOLUONG_NGAY08) AS SOLUONG_NGAY08,
       SUM(union_data.THANHTIEN_NGAY08) AS THANHTIEN_NGAY08,
       SUM(union_data.SOLUONG_NGAY09) AS SOLUONG_NGAY09,
       SUM(union_data.THANHTIEN_NGAY09) AS THANHTIEN_NGAY09,
       SUM(union_data.SOLUONG_NGAY10) AS SOLUONG_NGAY10,
       SUM(union_data.THANHTIEN_NGAY10) AS THANHTIEN_NGAY10,
       SUM(union_data.SOLUONG_CAP) AS SOLUONG_CAP,
       SUM(union_data.THANHTIEN_CAP) AS THANHTIEN_CAP
FROM
( -- Thuoc noi tru ngay 01
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       SOLUONG AS SOLUONG_NGAY01, THANHTIEN AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT 
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_01})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA, dmthuoc.DMTHUOC_TEN,dvt.DMDONVITINH_TEN, dmlt.DMLOAITHUOC_MA) v_tnt_ngay01

UNION ALL
 -- Thuoc noi tru ngay 02
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       SOLUONG AS SOLUONG_NGAY02, THANHTIEN AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT 
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_02})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})            
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay02
UNION ALL
 -- Thuoc noi tru ngay 03
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       SOLUONG AS SOLUONG_NGAY03, THANHTIEN AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_03})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay03
UNION ALL
 -- Thuoc noi tru ngay 04
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       SOLUONG AS SOLUONG_NGAY04, THANHTIEN AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_04})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay04    
UNION ALL
 -- Thuoc noi tru ngay 05
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       SOLUONG AS SOLUONG_NGAY05, THANHTIEN AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_05})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay05                
UNION ALL
 -- Thuoc noi tru ngay 06
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       SOLUONG AS SOLUONG_NGAY06, THANHTIEN AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_06})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay06
UNION ALL
 -- Thuoc noi tru ngay 07
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       SOLUONG AS SOLUONG_NGAY07, THANHTIEN AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_07})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC, dmthuoc.DMTHUOC_MA,TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay07
UNION ALL
 -- Thuoc noi tru ngay 08
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       SOLUONG AS SOLUONG_NGAY08, THANHTIEN AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_08})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay08
UNION ALL
 -- Thuoc noi tru ngay 09
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       SOLUONG AS SOLUONG_NGAY09, THANHTIEN AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_09})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay09
UNION ALL
 -- Thuoc noi tru ngay 10
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       SOLUONG AS SOLUONG_NGAY10, THANHTIEN AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT <> 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) = TO_DATE($P{NGAY_10})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA, TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ngay10
UNION ALL
 -- Thuoc noi ke toa ve
 SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,       
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       SOLUONG AS SOLUONG_CAP, THANHTIEN AS THANHTIEN_CAP
 FROM (SELECT
         dmthuoc.DMTHUOC_MA AS MATHUOC,
         dmthuoc.DMTHUOC_TEN AS TENTHUOC,
         dvt.DMDONVITINH_TEN AS DONVITINH,
         TO_DATE(tnt.THUOCNOITRU_NGAYGIO) NGAY,
         SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) AS SOLUONG,
         -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
         (tnt.THUOCNOITRU_DONGIA * (SUM(tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)))) AS THANHTIEN,
         dmlt.DMLOAITHUOC_MA
        FROM thuoc_noi_tru tnt, hsba_khoa hsbakhoa, hsba , dm_thuoc  dmthuoc, dm_don_vi_tinh dvt,
             dm_phan_loai_thuoc dmplt, dm_loai_thuoc dmlt
      WHERE tnt.HSBA_KHOA = hsbakhoa.HSBAKHOA_MASO
            AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
            -- AND hsbakhoa.KHOA_MA = hsba.HSBA_KHOADANGDT
            AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
            AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
            AND tnt.THUOCNOITRU_MATHUOC = dmthuoc.DMTHUOC_MASO
            AND dmthuoc.DMDONVITINH_MASO = dvt.DMDONVITINH_MASO
            AND dmthuoc.DMPHANLOAITHUOC_MASO = dmplt.DMPHANLOAITHUOC_MASO
            AND dmplt.DMLOAITHUOC_MASO = dmlt.DMLOAITHUOC_MASO
            AND (tnt.THUOCNOITRU_SOLUONG - COALESCE(tnt.THUOCNOITRU_TRA,0)) > 0
            AND tnt.THUOCNOITRU_TUTRUC_PDT = 2 
            AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) >= TO_DATE($P{TUNGAY})
            AND TO_DATE(tnt.THUOCNOITRU_NGAYGIO) <= TO_DATE($P{DENNGAY})
            GROUP BY hsba.HSBA_SOVAOVIEN,tnt.THUOCNOITRU_MATHUOC,dmthuoc.DMTHUOC_MA,TO_DATE(tnt.THUOCNOITRU_NGAYGIO),tnt.THUOCNOITRU_DONGIA,dmthuoc.DMTHUOC_TEN, dvt.DMDONVITINH_TEN,dmlt.DMLOAITHUOC_MA) v_tnt_ketoave                                        
UNION ALL
-- Thong tin can lam sang ngay 01
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       SOLUONG AS SOLUONG_NGAY01, THANHTIEN AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
	 AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_01})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay01
UNION ALL
-- Thong tin can lam sang ngay 02
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       SOLUONG AS SOLUONG_NGAY02, THANHTIEN AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_02})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay02

UNION ALL
-- Thong tin can lam sang ngay 03
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       SOLUONG AS SOLUONG_NGAY03, THANHTIEN AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_03})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay03

UNION ALL
-- Thong tin can lam sang ngay 04
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       SOLUONG AS SOLUONG_NGAY04, THANHTIEN AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_04})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay04

UNION ALL
-- Thong tin can lam sang ngay 05
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       SOLUONG AS SOLUONG_NGAY05, THANHTIEN AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_05})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay05

UNION ALL
-- Thong tin can lam sang ngay 06
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       SOLUONG AS SOLUONG_NGAY06, THANHTIEN AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_06})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay06

UNION ALL
-- Thong tin can lam sang ngay 07
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       SOLUONG AS SOLUONG_NGAY07, THANHTIEN AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_07})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay07

UNION ALL
-- Thong tin can lam sang ngay 08
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       SOLUONG AS SOLUONG_NGAY08, THANHTIEN AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_08})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay08

UNION ALL
-- Thong tin can lam sang ngay 09
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       SOLUONG AS SOLUONG_NGAY09, THANHTIEN AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
     AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_09})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay09

UNION ALL
-- Thong tin can lam sang ngay 10
SELECT  MATHUOC,TENTHUOC,DONVITINH, DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       SOLUONG AS SOLUONG_NGAY10, THANHTIEN AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
 FROM (
SELECT
       dmcls.DTDMCLS_TEN AS MATHUOC,
       dmclsbg.DTDMCLSBG_DIENGIAI AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) AS SOLUONG,
       -- SUM(clsmo.CLSMO_DONGIABNTRA) AS THANHTIEN,
       -- Fix bug 3328 : lay chi phi benh nhan su dung (thay cho chi phi benh nhan tra sau khi tru bao hiem)
       (clsmo.CLSMO_DONGIA * (SUM(clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)))) AS THANHTIEN,
       clsmo.CLSMO_NGAY
FROM cls_mo clsmo, hsba_khoa hsbakhoa, hsba, dt_dm_cls dmcls, dt_dm_cls_bang_gia dmclsbg
WHERE clsmo.HSBAKHOA_MASO = hsbakhoa.HSBAKHOA_MASO
     AND hsbakhoa.HSBA_SOVAOVIEN = hsba.HSBA_SOVAOVIEN
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND ($P{TANGMASO} is null  OR hsbakhoa.DMTANG_MASO = $P{TANGMASO} OR hsbakhoa.DMTANG_MASO is null)
     AND ($P{KHOAMA} is null OR hsbakhoa.KHOA_MA = $P{KHOAMA})
     AND clsmo.CLSMO_LOAICLS = dmcls.DTDMCLS_MASO
     AND clsmo.CLSMO_MAHANG = dmclsbg.DTDMCLSBG_MASO
     AND (clsmo.CLSMO_LAN - COALESCE(clsmo.CLSMO_TRA,0)) > 0
    AND hsba.HSBA_SOVAOVIEN = $P{SOVAOVIEN}
     AND TO_DATE(clsmo.CLSMO_NGAY) = TO_DATE($P{NGAY_10})
     AND TO_DATE(clsmo.CLSMO_NGAY) <= TO_DATE($P{DENNGAY})
GROUP BY  hsba.HSBA_SOVAOVIEN, clsmo.CLSMO_MAHANG, clsmo.CLSMO_NGAY, clsmo.CLSMO_DONGIA,dmcls.DTDMCLS_TEN,dmclsbg.DTDMCLSBG_DIENGIAI) v_cls_ngay10
UNION ALL
-- View thong tin an ngay 01
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       v.LANAN AS SOLUONG_NGAY01, CAST(v.MUCAN AS DECIMAL)  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_01})
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
       AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
 UNION ALL
 -- View thong tin an ngay 02
 SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0 AS THANHTIEN_NGAY01,
       v.LANAN AS SOLUONG_NGAY02, CAST(v.MUCAN AS DECIMAL)  AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_02})
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
      AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 03
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       v.LANAN AS SOLUONG_NGAY03, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_03})
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
       AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 04
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       v.LANAN AS SOLUONG_NGAY04, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_04}) 
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
       AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 05
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       v.LANAN AS SOLUONG_NGAY05, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_05}) 
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
       AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 06
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       v.LANAN AS SOLUONG_NGAY06, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_06}) 
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
      AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 07
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       v.LANAN AS SOLUONG_NGAY07, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_07})  
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
      AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 08
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       v.LANAN AS SOLUONG_NGAY08, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_08})   
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
      AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 09
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       v.LANAN AS SOLUONG_NGAY09, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY09,
       0 AS SOLUONG_NGAY10, 0 AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_09})    
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
      AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
UNION ALL
-- View thong tin an ngay 10
SELECT ' An' AS MATHUOC,
        ' ' AS TENTHUOC,
       ' ' AS DONVITINH,
       ' ' AS DMLOAITHUOC_MA,
       0 AS SOLUONG_NGAY01, 0  AS THANHTIEN_NGAY01,
       0 AS SOLUONG_NGAY02, 0 AS THANHTIEN_NGAY02,
       0 AS SOLUONG_NGAY03, 0 AS THANHTIEN_NGAY03,
       0 AS SOLUONG_NGAY04, 0 AS THANHTIEN_NGAY04,
       0 AS SOLUONG_NGAY05, 0 AS THANHTIEN_NGAY05,
       0 AS SOLUONG_NGAY06, 0 AS THANHTIEN_NGAY06,
       0 AS SOLUONG_NGAY07, 0 AS THANHTIEN_NGAY07,
       0 AS SOLUONG_NGAY08, 0 AS THANHTIEN_NGAY08,
       0 AS SOLUONG_NGAY09, 0 AS THANHTIEN_NGAY09,
       v.LANAN AS SOLUONG_NGAY10, CAST(v.MUCAN AS DECIMAL) AS THANHTIEN_NGAY10,
       0 AS SOLUONG_CAP, 0 AS THANHTIEN_CAP
FROM  v_thongtinan v
 WHERE v.HSBA_SOVAOVIEN = $P{SOVAOVIEN} AND  TO_DATE(v.NGAYAN) = TO_DATE($P{NGAY_10}) 
       AND TO_DATE(v.NGAYAN) <= TO_DATE($P{DENNGAY})
       AND ($P{KHOAMA} is null or v.KHOA_MASO = $P{KHOAMA})
) union_data
GROUP BY union_data.MATHUOC,
       union_data.TENTHUOC,
       union_data.DONVITINH,
       union_data.DMLOAITHUOC_MA) v_all
ORDER BY v_all.TEN_NHOM ASC, v_all.TEN_CHITIET ASC]]></queryString>

	<field name="TEN_NHOM" class="java.lang.String"/>
	<field name="TEN_CHITIET" class="java.lang.String"/>
	<field name="DONVITINH" class="java.lang.String"/>
	<field name="SOLUONG_NGAY01" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY01" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY02" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY02" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY03" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY03" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY04" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY04" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY05" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY05" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY06" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY06" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY07" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY07" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY08" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY08" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY09" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY09" class="java.lang.Double"/>
	<field name="SOLUONG_NGAY10" class="java.lang.Double"/>
	<field name="THANHTIEN_NGAY10" class="java.lang.Double"/>
	<field name="SOLUONG_CAP" class="java.lang.Double"/>
	<field name="THANHTIEN_CAP" class="java.lang.Double"/>


		<group  name="TENNHOM_GRP" >
			<groupExpression><![CDATA[$F{TEN_NHOM}]]></groupExpression>
			<groupHeader>
			<band height="20"  isSplitAllowed="true" >
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="0"
						y="0"
						width="822"
						height="20"
						key="textField-23"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{TEN_NHOM}.trim().toUpperCase()]]></textFieldExpression>
				</textField>
			</band>
			</groupHeader>
			<groupFooter>
			<band height="60"  isSplitAllowed="true" >
				<printWhenExpression><![CDATA[new Boolean($F{TEN_NHOM}.toString().trim().toUpperCase().equals("TÊN THUỐC, HÀM LƯỢNG"))]]></printWhenExpression>
				<staticText>
					<reportElement
						x="0"
						y="0"
						width="34"
						height="20"
						key="staticText-14"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="34"
						y="0"
						width="161"
						height="20"
						key="staticText-15"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="195"
						y="0"
						width="51"
						height="20"
						key="staticText-16"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="246"
						y="0"
						width="37"
						height="20"
						key="staticText-17"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="283"
						y="0"
						width="37"
						height="20"
						key="staticText-18"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="320"
						y="0"
						width="37"
						height="20"
						key="staticText-19"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="357"
						y="0"
						width="37"
						height="20"
						key="staticText-20"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="394"
						y="0"
						width="37"
						height="20"
						key="staticText-21"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="431"
						y="0"
						width="37"
						height="20"
						key="staticText-22"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="468"
						y="0"
						width="37"
						height="20"
						key="staticText-23"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="505"
						y="0"
						width="37"
						height="20"
						key="staticText-24"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="542"
						y="0"
						width="37"
						height="20"
						key="staticText-25"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="579"
						y="0"
						width="37"
						height="20"
						key="staticText-26"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="653"
						y="0"
						width="64"
						height="20"
						key="staticText-27"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="717"
						y="0"
						width="105"
						height="20"
						key="staticText-28"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="20"
						width="34"
						height="20"
						key="staticText-29"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="34"
						y="20"
						width="161"
						height="20"
						key="staticText-30"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="195"
						y="20"
						width="51"
						height="20"
						key="staticText-31"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="246"
						y="20"
						width="37"
						height="20"
						key="staticText-32"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="283"
						y="20"
						width="37"
						height="20"
						key="staticText-33"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="320"
						y="20"
						width="37"
						height="20"
						key="staticText-34"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="357"
						y="20"
						width="37"
						height="20"
						key="staticText-35"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="394"
						y="20"
						width="37"
						height="20"
						key="staticText-36"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="431"
						y="20"
						width="37"
						height="20"
						key="staticText-37"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="468"
						y="20"
						width="37"
						height="20"
						key="staticText-38"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="505"
						y="20"
						width="37"
						height="20"
						key="staticText-39"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="542"
						y="20"
						width="37"
						height="20"
						key="staticText-40"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="579"
						y="20"
						width="37"
						height="20"
						key="staticText-41"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="653"
						y="20"
						width="64"
						height="20"
						key="staticText-42"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="717"
						y="20"
						width="105"
						height="20"
						key="staticText-43"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="40"
						width="34"
						height="20"
						key="staticText-44"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="34"
						y="40"
						width="161"
						height="20"
						key="staticText-45"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="195"
						y="40"
						width="51"
						height="20"
						key="staticText-46"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="246"
						y="40"
						width="37"
						height="20"
						key="staticText-47"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="283"
						y="40"
						width="37"
						height="20"
						key="staticText-48"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="320"
						y="40"
						width="37"
						height="20"
						key="staticText-49"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="357"
						y="40"
						width="37"
						height="20"
						key="staticText-50"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="394"
						y="40"
						width="37"
						height="20"
						key="staticText-51"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="431"
						y="40"
						width="37"
						height="20"
						key="staticText-52"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="468"
						y="40"
						width="37"
						height="20"
						key="staticText-53"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="505"
						y="40"
						width="37"
						height="20"
						key="staticText-54"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="542"
						y="40"
						width="37"
						height="20"
						key="staticText-55"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="579"
						y="40"
						width="37"
						height="20"
						key="staticText-56"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="653"
						y="40"
						width="64"
						height="20"
						key="staticText-57"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="717"
						y="40"
						width="105"
						height="20"
						key="staticText-58"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="616"
						y="0"
						width="37"
						height="20"
						key="staticText-59"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="616"
						y="20"
						width="37"
						height="20"
						key="staticText-60"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="616"
						y="40"
						width="37"
						height="20"
						key="staticText-61"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
			</band>
			</groupFooter>
		</group>
		<background>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</background>
		<title>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</title>
		<pageHeader>
			<band height="40"  isSplitAllowed="true" >
				<staticText>
					<reportElement
						x="0"
						y="0"
						width="34"
						height="40"
						key="staticText-1"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[STT]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="34"
						y="0"
						width="161"
						height="40"
						key="staticText-2"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="3" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[NỘI DUNG]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="195"
						y="0"
						width="51"
						height="20"
						key="staticText-3"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[Ngày]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="195"
						y="20"
						width="51"
						height="20"
						key="staticText-4"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[Đơn vị]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="246"
						y="0"
						width="37"
						height="20"
						key="textField-1"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_01}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_01}.getDate() < 10 ? "0" + $P{NGAY_01}.getDate() : "" + $P{NGAY_01}.getDate())
+ "/" + (($P{NGAY_01}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_01}.getMonth() +1) : "" + ($P{NGAY_01}.getMonth() +1)) : null)]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="283"
						y="0"
						width="37"
						height="20"
						key="textField-2"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_02}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_02}.getDate() < 10 ? "0" + $P{NGAY_02}.getDate() : "" + $P{NGAY_02}.getDate())
+ "/" + (($P{NGAY_02}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_02}.getMonth() +1) : "" + ($P{NGAY_02}.getMonth() +1)) : 
($P{NGAY_01}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="320"
						y="0"
						width="37"
						height="20"
						key="textField-3"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_03}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_03}.getDate() < 10 ? "0" + $P{NGAY_03}.getDate() : "" + $P{NGAY_03}.getDate())
+ "/" + (($P{NGAY_03}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_03}.getMonth() +1) : "" + ($P{NGAY_03}.getMonth() +1)) : 
($P{NGAY_02}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="357"
						y="0"
						width="37"
						height="20"
						key="textField-4"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_04}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_04}.getDate() < 10 ? "0" + $P{NGAY_04}.getDate() : "" + $P{NGAY_04}.getDate())
+ "/" + (($P{NGAY_04}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_04}.getMonth() +1) : "" + ($P{NGAY_04}.getMonth() +1)) : 
($P{NGAY_03}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="394"
						y="0"
						width="37"
						height="20"
						key="textField-5"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_05}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_05}.getDate() < 10 ? "0" + $P{NGAY_05}.getDate() : "" + $P{NGAY_05}.getDate())
+ "/" + (($P{NGAY_05}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_05}.getMonth() +1) : "" + ($P{NGAY_05}.getMonth() +1)) : 
($P{NGAY_04}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="431"
						y="0"
						width="37"
						height="20"
						key="textField-6"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_06}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_06}.getDate() < 10 ? "0" + $P{NGAY_06}.getDate() : "" + $P{NGAY_06}.getDate())
+ "/" + (($P{NGAY_06}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_06}.getMonth() +1) : "" + ($P{NGAY_06}.getMonth() +1)) : 
($P{NGAY_05}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="468"
						y="0"
						width="37"
						height="20"
						key="textField-7"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_07}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_07}.getDate() < 10 ? "0" + $P{NGAY_07}.getDate() : "" + $P{NGAY_07}.getDate())
+ "/" + (($P{NGAY_07}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_07}.getMonth() +1) : "" + ($P{NGAY_07}.getMonth() +1)) : 
($P{NGAY_06}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="505"
						y="0"
						width="37"
						height="20"
						key="textField-8"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_08}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_08}.getDate() < 10 ? "0" + $P{NGAY_08}.getDate() : "" + $P{NGAY_08}.getDate())
+ "/" + (($P{NGAY_08}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_08}.getMonth() +1) : "" + ($P{NGAY_08}.getMonth() +1)) : 
($P{NGAY_07}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement
						x="653"
						y="0"
						width="64"
						height="40"
						key="staticText-5"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[Tổng số]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="717"
						y="0"
						width="105"
						height="40"
						key="staticText-7"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[Thành tiền]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="246"
						y="20"
						width="407"
						height="20"
						key="staticText-8"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[Giờ thực hiện]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="542"
						y="0"
						width="37"
						height="20"
						key="textField-25"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_09}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_09}.getDate() < 10 ? "0" + $P{NGAY_09}.getDate() : "" + $P{NGAY_09}.getDate())
+ "/" + (($P{NGAY_09}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_09}.getMonth() +1) : "" + ($P{NGAY_09}.getMonth() +1)) :
($P{NGAY_08}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="579"
						y="0"
						width="37"
						height="20"
						key="textField-26"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_10}.compareTo($P{DENNGAY} ) <= 0 ? 
"" + ($P{NGAY_10}.getDate() < 10 ? "0" + $P{NGAY_10}.getDate() : "" + $P{NGAY_10}.getDate())
+ "/" + (($P{NGAY_10}.getMonth() + 1) < 10 ? "0" + ($P{NGAY_10}.getMonth() +1) : "" + ($P{NGAY_10}.getMonth() +1)) : 
($P{NGAY_09}.compareTo($P{DENNGAY} ) == 0 ? "Cấp" : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="dd/MM" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="616"
						y="0"
						width="37"
						height="20"
						key="textField-30"/>
					<box topBorder="Thin" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_10}.compareTo($P{DENNGAY}) == 0  ? "Cấp" : null)]]></textFieldExpression>
				</textField>
			</band>
		</pageHeader>
		<columnHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnHeader>
		<detail>
			<band height="20"  isSplitAllowed="true" >
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="0"
						y="0"
						width="34"
						height="20"
						key="textField-9"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.Integer"><![CDATA[$V{TENNHOM_GRP_COUNT}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="34"
						y="0"
						width="161"
						height="20"
						key="textField-10"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" topPadding="2" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" rightPadding="1" bottomBorder="Thin" bottomBorderColor="#000000" bottomPadding="2"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{TEN_CHITIET}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="195"
						y="0"
						width="51"
						height="20"
						key="textField-11"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{DONVITINH}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="246"
						y="0"
						width="37"
						height="20"
						key="textField-12"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_01}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY01} == null ? new Double(0.0) : $F{SOLUONG_NGAY01}) : null)]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="283"
						y="0"
						width="37"
						height="20"
						key="textField-13"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_02}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY02} == null ? new Double(0.0) : $F{SOLUONG_NGAY02}) : 
($P{NGAY_01}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="320"
						y="0"
						width="37"
						height="20"
						key="textField-14"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_03}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY03} == null ? new Double(0.0) : $F{SOLUONG_NGAY03}) : 
($P{NGAY_02}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="357"
						y="0"
						width="37"
						height="20"
						key="textField-15"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_04}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY04} == null ? new Double(0.0) : $F{SOLUONG_NGAY04}) : 
($P{NGAY_03}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="394"
						y="0"
						width="37"
						height="20"
						key="textField-16"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_05}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY05} == null ? new Double(0.0) : $F{SOLUONG_NGAY05}) : 
($P{NGAY_04}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="431"
						y="0"
						width="37"
						height="20"
						key="textField-17"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_06}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY06} == null ? new Double(0.0) : $F{SOLUONG_NGAY06}) : 
($P{NGAY_05}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="468"
						y="0"
						width="37"
						height="20"
						key="textField-18"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_07}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY07} == null ? new Double(0.0) : $F{SOLUONG_NGAY07}) : 
($P{NGAY_06}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="505"
						y="0"
						width="37"
						height="20"
						key="textField-19"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_08}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY08} == null ? new Double(0.0) : $F{SOLUONG_NGAY08}) : 
($P{NGAY_07}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="653"
						y="0"
						width="64"
						height="20"
						key="textField-20"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[CommaSeparator.formatDoubleWithSeprator(new Double(
($P{NGAY_01}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY01} == null ? 0 : $F{SOLUONG_NGAY01}.doubleValue()) : 0) +
($P{NGAY_02}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY02} == null ? 0 : $F{SOLUONG_NGAY02}.doubleValue()) : 0) +
($P{NGAY_03}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY03} == null ? 0 : $F{SOLUONG_NGAY03}.doubleValue()) : 0) +
($P{NGAY_04}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY04} == null ? 0 : $F{SOLUONG_NGAY04}.doubleValue()) : 0) +
($P{NGAY_05}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY05} == null ? 0 : $F{SOLUONG_NGAY05}.doubleValue()) : 0) +
($P{NGAY_06}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY06} == null ? 0 : $F{SOLUONG_NGAY06}.doubleValue()) : 0) +
($P{NGAY_07}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY07} == null ? 0 : $F{SOLUONG_NGAY07}.doubleValue()) : 0) +
($P{NGAY_08}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY08} == null ? 0 : $F{SOLUONG_NGAY08}.doubleValue()) : 0) +
($P{NGAY_09}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY09} == null ? 0 : $F{SOLUONG_NGAY09}.doubleValue()) : 0) +
($P{NGAY_10}.compareTo($P{DENNGAY} ) <= 0 ? ($F{SOLUONG_NGAY10} == null ? 0 : $F{SOLUONG_NGAY10}.doubleValue()) : 0) +
($F{SOLUONG_CAP} == null ? 0 : $F{SOLUONG_CAP}.doubleValue())
))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="717"
						y="0"
						width="105"
						height="20"
						key="textField-22"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[CommaSeparator.formatDoubleWithSeprator(new Double(
($P{NGAY_01}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY01} == null ? 0 : $F{THANHTIEN_NGAY01}.doubleValue()) : 0) +
($P{NGAY_02}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY02} == null ? 0 : $F{THANHTIEN_NGAY02}.doubleValue()) : 0) +
($P{NGAY_03}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY03} == null ? 0 : $F{THANHTIEN_NGAY03}.doubleValue()) : 0) +
($P{NGAY_04}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY04} == null ? 0 : $F{THANHTIEN_NGAY04}.doubleValue()) : 0) +
($P{NGAY_05}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY05} == null ? 0 : $F{THANHTIEN_NGAY05}.doubleValue()) : 0) +
($P{NGAY_06}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY06} == null ? 0 : $F{THANHTIEN_NGAY06}.doubleValue()) : 0) +
($P{NGAY_07}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY07} == null ? 0 : $F{THANHTIEN_NGAY07}.doubleValue()) : 0) +
($P{NGAY_08}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY08} == null ? 0 : $F{THANHTIEN_NGAY08}.doubleValue()) : 0) +
($P{NGAY_09}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY09} == null ? 0 : $F{THANHTIEN_NGAY09}.doubleValue()) : 0) +
($P{NGAY_10}.compareTo($P{DENNGAY} ) <= 0 ? ($F{THANHTIEN_NGAY10} == null ? 0 : $F{THANHTIEN_NGAY10}.doubleValue()) : 0) +
($F{THANHTIEN_CAP} == null ? 0 : $F{THANHTIEN_CAP}.doubleValue())
))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="542"
						y="0"
						width="37"
						height="20"
						key="textField-27"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_09}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY09} == null ? new Double(0.0) : $F{SOLUONG_NGAY09}) : 
($P{NGAY_08}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="579"
						y="0"
						width="37"
						height="20"
						key="textField-28"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_10}.compareTo($P{DENNGAY} ) <= 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_NGAY10} == null ? new Double(0.0) : $F{SOLUONG_NGAY10}) : 
($P{NGAY_09}.compareTo($P{DENNGAY} ) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP}) : null))]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="616"
						y="0"
						width="37"
						height="20"
						key="textField-31"
						stretchType="RelativeToTallestObject"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" leftPadding="2" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[($P{NGAY_10}.compareTo($P{DENNGAY}) == 0 ? CommaSeparator.formatDoubleWithSeprator($F{SOLUONG_CAP} == null ? new Double(0.0) : $F{SOLUONG_CAP}) : null)]]></textFieldExpression>
				</textField>
			</band>
		</detail>
		<columnFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnFooter>
		<pageFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageFooter>
		<lastPageFooter>
			<band height="112"  isSplitAllowed="true" >
				<staticText>
					<reportElement
						x="0"
						y="0"
						width="394"
						height="42"
						key="staticText-11"/>
					<box topBorder="None" topBorderColor="#000000" topPadding="16" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<text><![CDATA[Người bệnh ký tên]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="394"
						y="0"
						width="428"
						height="42"
						key="textField-29"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA["Ngày " + 
(new Date().getDate() < 10 ? "0" + new Date().getDate() : "" + new Date().getDate()) + 
" tháng " + 
((new Date().getMonth() + 1) < 10 ? "0" + (new Date().getMonth() + 1) : "" + (new Date().getMonth() + 1)) + 
" năm " + 
(new Date().getYear() < 1900 ? (new Date().getYear() + 1900) : new Date().getYear())]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement
						x="394"
						y="42"
						width="428"
						height="70"
						key="staticText-12"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="Thin" leftBorderColor="#000000" rightBorder="Thin" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Top">
						<font reportFont="Time New Roman" pdfFontName="timesbd.ttf" isBold="true"/>
					</textElement>
				<text><![CDATA[ĐD PHỤ TRÁCH]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="42"
						width="394"
						height="70"
						key="staticText-13"/>
					<box topBorder="None" topBorderColor="#000000" topPadding="16" leftBorder="Thin" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="Thin" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font reportFont="Time New Roman"/>
					</textElement>
				<text><![CDATA[]]></text>
				</staticText>
			</band>
		</lastPageFooter>
		<summary>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</summary>
</jasperReport>
